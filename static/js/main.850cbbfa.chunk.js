(this["webpackJsonpenglish-fight-ui"]=this["webpackJsonpenglish-fight-ui"]||[]).push([[0],{213:function(e,t,n){e.exports={errorMessage:"App_errorMessage__29Ukm"}},386:function(e,t,n){},394:function(e,t,n){},395:function(e,t,n){},396:function(e,t,n){},398:function(e,t,n){},399:function(e,t,n){},400:function(e,t,n){},401:function(e,t,n){},402:function(e,t,n){},404:function(e,t,n){"use strict";n.r(t);n(273),n(299),n(301),n(302),n(304),n(305),n(306),n(307),n(308),n(309),n(310),n(311),n(313),n(314),n(315),n(316),n(317),n(318),n(319),n(320),n(321),n(322),n(324),n(325),n(326),n(327),n(328),n(329),n(330),n(331),n(332),n(333),n(334),n(335),n(336),n(337),n(338),n(339),n(340),n(341);var r=n(1),a=n(0),c=n.n(a),i=n(198),o=n(59),s=n.n(o),u=n(6),l=n.n(u),d=n(13),j=n(7),b=n(11),f=function(){function e(){Object(j.a)(this,e)}return Object(b.a)(e,null,[{key:"waitForTimeout",value:function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout(e,t)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"waitTillTimestamp",value:function(){var t=Object(d.a)(l.a.mark((function t(n){var r,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=(new Date).getTime(),!((a=n-r)>0)){t.next=4;break}return t.abrupt("return",e.waitForTimeout(a));case 4:return t.abrupt("return",Promise.resolve());case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}]),e}();f.isProductionMode=!0;var p=n(410),h=n(54),O=n.n(h);function m(e){var t=e.children;return f.isProductionMode?Object(r.jsx)(p.a,{fallback:function(e){var t=e.error,n=e.componentStack,a=e.resetError;return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("div",{children:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0442\u0440\u0438\u0441\u043e\u0432\u043a\u0438:"}),Object(r.jsx)("p",{children:t.message}),Object(r.jsx)("p",{children:n}),Object(r.jsx)(O.a,{onClick:a,children:"\u041f\u043e\u043f\u0440\u043e\u0431\u043e\u0432\u0430\u0442\u044c \u0435\u0449\u0435 \u0440\u0430\u0437"})]})},children:t}):t}var v=n(15),x=n(216),k=n(90),g=n(107),w=n(201),y=n.n(w),S=n(39),N=n(202),T=n.n(N),C=n(18),_=n.n(C),E=n(102),B=n.n(E),U=n(203),F=n.n(U);function R(e){return function(t){return T()(t,e)}}function A(e,t){return this.constructor.update(this,Object(S.a)({},e,{$set:t}))}var P=new Map;function M(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Object(C.struct)(e,{name:t,defaultProps:n});return r.fromObject=R(r),r.prototype.set=A,P.set(t,r),r}var G,D=function(){function e(){Object(j.a)(this,e)}return Object(b.a)(e,null,[{key:"getSearchParam",value:function(e){return new URLSearchParams(window.location.search).get(e)}},{key:"getHashParam",value:function(e){return new URLSearchParams(window.location.hash.slice(1)).get(e)}}]),e}(),I=n(119),L=n.n(I),H="https://enfight.tmweb.ru",z=H.includes("https://")?"wss://":"ws://",Q="\u0412\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u044f\u044f \u043e\u0448\u0438\u0431\u043a\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0430",W={3e3:"\u041d\u0435 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d"},q=3001,K=3002,V=function(){function e(){Object(j.a)(this,e)}return Object(b.a)(e,null,[{key:"post",value:function(){var t=Object(d.a)(l.a.mark((function t(n,r){var a,c,i,o,s,u,d,j=arguments;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=j.length>2&&void 0!==j[2]?j[2]:{},c=a.sendToken,i=void 0===c||c,o=a.expand,s=void 0===o?"":o,u=a.Model,d=void 0===u?null:u,t.abrupt("return",e.send(n,{data:e.convertDataToBackendFormat(r),sendToken:i,method:"POST",expand:s,Model:d}));case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"patch",value:function(){var t=Object(d.a)(l.a.mark((function t(n,r){var a,c,i,o,s,u,d,j=arguments;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=j.length>2&&void 0!==j[2]?j[2]:{},c=a.sendToken,i=void 0===c||c,o=a.expand,s=void 0===o?"":o,u=a.Model,d=void 0===u?null:u,t.abrupt("return",e.send(n,{data:e.convertDataToBackendFormat(r),sendToken:i,method:"PATCH",expand:s,Model:d}));case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"get",value:function(){var t=Object(d.a)(l.a.mark((function t(n){var r,a,c,i,o,s=arguments;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=s.length>1&&void 0!==s[1]?s[1]:{},a=r.expand,c=void 0===a?"":a,i=r.Model,o=void 0===i?null:i,t.abrupt("return",e.send(n,{sendToken:!0,method:"GET",expand:c,Model:o}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"send",value:function(){var t=Object(d.a)(l.a.mark((function t(n,r){var a,c,i,o,s,u,d,j,b,f;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=r.data,c=r.sendToken,i=r.method,o=r.expand,s=r.Model,u=void 0===s?null:s,d=new URLSearchParams,o&&(j=y()(o).join(","),d.append("expand",j)),b={headers:e.createHeaders({sendToken:c})},"GET"!==i&&(b.mode="cors",b.body=JSON.stringify(a)),b.method=i,t.next=8,Object(k.timeout)(fetch(e.createFullApiURL(n,d),b),1e4);case 8:return f=t.sent,t.abrupt("return",e.processResponse(f,u));case 10:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"openSocketConnection",value:function(t,n){var r=n.onMessage,a=void 0===r?function(){}:r,c=n.onOpen,i=void 0===c?function(){}:c,o=n.onClose,s=void 0===o?function(){}:o,u=n.onError,l=void 0===u?function(){}:u,d=Object(x.a)(n,["onMessage","onOpen","onClose","onError"]),j=e.createFullSocketURL(t),b=function(e){var t=W[e.code]||Q;throw W[e.code]||console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0432\u0435\u0431\u0441\u043e\u043a\u0435\u0442\u0430 #".concat(e.code)),new Error(t)},f=new WebSocket(j);f.addEventListener("message",(function(t){var n=JSON.parse(t.data),r=null;if(n.instance){var c=function(e){var t=F()(B()(e));if(!P.has(t))throw new Error('No model with name "'.concat(t,'" (converted from "').concat(e,'") found'));return P.get(t)}(n.model);r=e.convertDataToFrontendFormat(n.instance,c)}var i=null;n.data&&(i=e.convertDataToFrontendFormat(n.data));var o=B()(n.type),s=Object.prototype.hasOwnProperty.call(d,o),u={type:n.type,data:i,instance:r};s&&d[o](u),a(u)})),f.addEventListener("close",b),f.addEventListener("close",s),f.addEventListener("error",(function(){throw new Error("\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f")})),f.addEventListener("error",l);var p=f.close;f.close=function(){f.removeEventListener("close",b);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];p.apply(f,t)},f.sendJson=function(e){f.send(JSON.stringify(e))},f.sendEvent=function(e,t){this.sendJson(L()({type:e,data:t},(function(e){return e})))};var h=f;return f.addEventListener("open",(function(){h.sendEvent("authenticate",{authorization:e.getAuthorizationHeader()})})),f.addEventListener("open",i),h}},{key:"createHeaders",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.sendToken,r={Accept:"application/json","Content-Type":"application/json"};return n&&(r.Authorization=e.getAuthorizationHeader()),r}},{key:"getAuthorizationHeader",value:function(){if(D.getSearchParam("fake_vk_id")){if(f.isProductionMode)throw new Error("You cannot use fake_vk_id in production");return e.getFakeVKIDAuthHeader()}return e.getQueryStringAuthHeader()}},{key:"getQueryStringAuthHeader",value:function(){var e=window.location.search.slice(1);return"QueryString ".concat(e)}},{key:"getFakeVKIDAuthHeader",value:function(){var e=D.getSearchParam("fake_vk_id");return"FakeVKID ".concat(e)}},{key:"createFullApiURL",value:function(t,n){return e.createFullUrl("api/".concat(t),n)}},{key:"createFullSocketURL",value:function(t){var n="ws/".concat(t),r=e.removeTrailingSlash(H);return r=r.slice(r.indexOf("://")+3),"".concat(z).concat(r,"/").concat(n)}},{key:"createFullUrl",value:function(t,n){var r=e.removeTrailingSlash(H),a="".concat(r,"/").concat(t);return n&&String(n)&&(a+="?".concat(String(n))),a}},{key:"processResponse",value:function(){var t=Object(d.a)(l.a.mark((function t(n){var r,a,c=arguments;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=c.length>1&&void 0!==c[1]?c[1]:null,!(n.status>=500&&n.status<600)){t.next=3;break}throw new Error(Q);case 3:return t.prev=3,t.next=6,n.json();case 6:a=t.sent,t.next=12;break;case 9:throw t.prev=9,t.t0=t.catch(3),new Error("\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u043e\u0442\u0432\u0435\u0442 \u0441\u0435\u0440\u0432\u0435\u0440\u0430");case 12:if(n.ok){t.next=16;break}if(!a.detail){t.next=15;break}throw new Error(a.detail);case 15:throw new Error("\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f");case 16:return t.abrupt("return",e.convertDataToFrontendFormat(a,r));case 17:case"end":return t.stop()}}),t,null,[[3,9]])})));return function(e){return t.apply(this,arguments)}}()},{key:"convertDataToBackendFormat",value:function(e){return Object(g.toSnake)(e)}},{key:"convertDataToFrontendFormat",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=Object(g.toCamel)(e);return t?t.fromObject(n):n}},{key:"removeTrailingSlash",value:function(e){return e.endsWith("/")?e.slice(0,-1):e}}]),e}(),J=n(24),X=n(44),Y=Object(C.irreducible)("Null",(function(e){return null===e})),Z=Object(C.refinement)(_.a.Number,(function(e){return e>=0}),"PositiveNumber"),$=Object(C.refinement)(_.a.Number,(function(e){return e>=1}),"ID"),ee={ALLOW:"allow",BLOCK:"block",TO_BE_REQUESTED:"to be requested"},te="word",ne="picture";!function(e){e.single="single",e.multi="multi"}(G||(G={}));var re=function(e){Object(J.a)(n,e);var t=Object(X.a)(n);function n(){return Object(j.a)(this,n),t.apply(this,arguments)}return n}(M({id:$,vkId:$,firstName:_.a.String,lastName:_.a.String,photoUrl:_.a.String,score:Z,monthlyScore:Z,foreverRank:Z,monthlyRank:Z,notificationsStatus:_.a.enums.of(Object.values(ee),"notificationsStatus")},"User")),ae=n(22),ce=function(e){return Object(ae.a)({AUTOMATIC_OPERATIONS:["*"]},e)},ie="70656700",oe=ce({init:function(){return Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:!function(e,t,n,r,a,c,i){e.ym=e.ym||function(){(e.ym.a=e.ym.a||[]).push(arguments)},e.ym.l=1*new Date,c=t.createElement(n),i=t.getElementsByTagName(n)[0],c.async=1,c.src="https://mc.yandex.ru/metrika/tag.js",i.parentNode.insertBefore(c,i)}(window,document,"script");try{ym(ie,"init",{clickmap:!0,trackLinks:!0,accurateTrackBounce:!0,webvisor:!0})}catch(t){console.log("Seems like Yandex metrika is blocked"),console.warn(t)}case 3:case"end":return e.stop()}}),e)})))()},identify:function(e,t){return Object(d.a)(l.a.mark((function n(){return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:try{window.ym(ie,"userParams",{UserID:e,vkId:t})}catch(r){console.log("Seems like Yandex metrika is blocked"),console.warn(r)}case 1:case"end":return n.stop()}}),n)})))()},reachGoal:function(e,t){return new Promise((function(n){try{window.ym(ie,"reachGoal",e,t,(function(){return n()}))}catch(r){console.log("Seems like Yandex metrika is blocked"),console.warn(r)}}))}}),se=n(94),ue=null;function le(){return de.apply(this,arguments)}function de(){return(de=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==ue){e.next=2;break}throw new Error("Tracker was not initialized");case 2:return e.next=4,ue;case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var je=ce({init:function(){return ue=new Promise((function(e){se.a.init("GPS_dg48IHXOj1ZkH2CZ0xTEHzFkQme7wTxDvieVRW0",{autocapture:!1,loaded:function(){return e()}})})),Object(k.timeout)(ue,1e4)},identify:function(e,t){return Object(d.a)(l.a.mark((function n(){var r;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,le();case 2:r={vkId:t,"utm source":D.getHashParam("utm_source")||""},se.a.identify(String(e)),se.a.people.set_once(r),se.a.register_once(r);case 6:case"end":return n.stop()}}),n)})))()},reachGoal:function(e,t){return Object(d.a)(l.a.mark((function n(){return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,le();case 2:se.a.capture(e,t);case 3:case"end":return n.stop()}}),n)})))()}}),be=ce({init:function(){return Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Init tracker");case 1:case"end":return e.stop()}}),e)})))()},identify:function(e,t){return Object(d.a)(l.a.mark((function n(){return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:console.log("linked session with userId ".concat(e,", vkId ").concat(t));case 1:case"end":return n.stop()}}),n)})))()},reachGoal:function(e,t){return Object(d.a)(l.a.mark((function n(){return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t?console.log("Reach goal ".concat(e," with params"),t):console.log("Reach goal ".concat(e));case 1:case"end":return n.stop()}}),n)})))()}}),fe={AUTOMATIC_OPERATIONS:["init"],init:function(){var e=document.createElement("script");e.type="application/javascript",e.async=!0,e.src="https://vk.com/js/api/openapi.js?168",e.onload=function(){window.VK.Retargeting.Init("VK-RTRG-801543-7s37b"),window.VK.Retargeting.Hit()},document.head.appendChild(e)},reachGoal:function(e){f.isProductionMode&&window.VK.Goal(e)}},pe="G-WQCZ3XH0QS",he=null;function Oe(){return me.apply(this,arguments)}function me(){return(me=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==he){e.next=2;break}throw new Error("Tracker was not initialized");case 2:return e.next=4,he;case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ve=ce({init:function(){var e=document.createElement("script");return e.setAttribute("async","1"),e.setAttribute("src","https://www.googletagmanager.com/gtag/js?id=".concat(pe)),document.body.append(e),function(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],window.gtag=e,e("js",new Date),e("config",pe)}(),he=new Promise((function(t){e.addEventListener("load",(function(){return t()}))})),Object(k.timeout)(he,1e4)},identify:function(e,t){return Object(d.a)(l.a.mark((function n(){var r;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Oe();case 2:r=L()({utmSource:D.getHashParam("utm_source")},(function(e){return e}));try{gtag("set","user_properties",Object(g.toSnake)(Object(ae.a)({id:e,vkId:t},r)))}catch(a){console.log("Seems like Google analytics is blocked"),console.warn(a)}case 4:case"end":return n.stop()}}),n)})))()},reachGoal:function(e,t){return Object(d.a)(l.a.mark((function n(){return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Oe();case 2:try{gtag("event",e,t)}catch(r){console.log("Seems like Google analytics is blocked"),console.warn(r)}case 3:case"end":return n.stop()}}),n)})))()}}),xe=n(95),ke=n.n(xe),ge=ce({init:function(){return Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ke.a.init("e93996ec9d92068567adf6bbb49e3e79");case 1:case"end":return e.stop()}}),e)})))()},identify:function(e,t){return Object(d.a)(l.a.mark((function n(){var r;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r={"vk id":t,"utm source":D.getHashParam("utm_source")||""},ke.a.identify(String(e)),ke.a.people.set_once(r),ke.a.register_once(r);case 4:case"end":return n.stop()}}),n)})))()},reachGoal:function(e,t){return Object(d.a)(l.a.mark((function n(){return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:ke.a.track(e,t);case 1:case"end":return n.stop()}}),n)})))()}}),we=f.isProductionMode?[oe,je,fe,ve,ge]:[be];function ye(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];we.forEach((function(t){("*"===t.AUTOMATIC_OPERATIONS[0]||t.AUTOMATIC_OPERATIONS.includes(e))&&t[e].apply(t,n)}))}var Se=function(e,t){ye("identify",e,t)},Ne=function(){ye("init")},Te=function(e,t){ye("reachGoal",e,t)},Ce=function(){function e(){Object(j.a)(this,e)}return Object(b.a)(e,null,[{key:"fetchUserData",value:function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",V.get("user",{Model:re}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"allowNotifications",value:function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Te("allow-notifications"),e.abrupt("return",V.patch("user",{notificationsStatus:ee.ALLOW},{Model:re}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"blockNotifications",value:function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Te("block-notifications"),e.abrupt("return",V.patch("user",{notificationsStatus:ee.BLOCK},{Model:re}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"requestNotifications",value:function(){var t=Object(d.a)(l.a.mark((function t(){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.areNotificationsEnabledOnVkSide){t.next=2;break}return t.abrupt("return",e.allowNotifications());case 2:return t.prev=2,t.next=5,s.a.send("VKWebAppAllowNotifications");case 5:if(n=t.sent,!n.result){t.next=9;break}return t.abrupt("return",e.allowNotifications());case 9:t.next=16;break;case 11:if(t.prev=11,t.t0=t.catch(2),"client_error"!==t.t0.error_type||!t.t0.error_data||4!==t.t0.error_data.error_code||"User denied"!==t.t0.error_data.error_reason){t.next=15;break}return t.abrupt("return",e.blockNotifications());case 15:throw t.t0;case 16:case"end":return t.stop()}}),t,null,[[2,11]])})));return function(){return t.apply(this,arguments)}}()}]),e}();Ce.areNotificationsEnabledOnVkSide=Boolean(parseInt(D.getSearchParam("vk_are_notifications_enabled"),10));var _e=function(e){var t=e.children,n=Object(a.useState)(null),r=Object(v.a)(n,2),c=r[0],i=r[1],o=Object(a.useState)(!1),s=Object(v.a)(o,2),u=s[0],j=s[1];function b(){return f.apply(this,arguments)}function f(){return(f=Object(d.a)(l.a.mark((function e(){var t,n,r=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]&&r[0],j(!0),e.prev=2,e.next=5,Ce.fetchUserData();case 5:if(n=e.sent,i(n),!t){e.next=15;break}if(n.notificationsStatus!==ee.ALLOW||Ce.areNotificationsEnabledOnVkSide){e.next=14;break}return e.t0=i,e.next=12,Ce.blockNotifications();case 12:e.t1=e.sent,(0,e.t0)(e.t1);case 14:Se(n.id,n.vkId);case 15:return e.prev=15,j(!1),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[2,,15,18]])})))).apply(this,arguments)}return Object(a.useEffect)((function(){b(!0)}),[]),t({user:c,loadingUser:u,setUser:i,refreshUser:function(){return b(!1)}})},Ee=n(86),Be=n(212),Ue=n.n(Be),Fe=(n(385),n(386),n(10)),Re=function(e){Object(J.a)(n,e);var t=Object(X.a)(n);function n(){return Object(j.a)(this,n),t.apply(this,arguments)}return n}(M({id:$,question:_.a.String,answerWords:_.a.list(_.a.String),correctAnswer:_.a.union([Y,_.a.String]),selectedAnswer:_.a.union([Y,_.a.String]),isCorrect:_.a.Boolean},"Question")),Ae=_.a.union([Re,_.a.Number]);Ae.dispatch=function(e){return"number"===typeof e?_.a.Number:Re};var Pe=function(e){Object(J.a)(n,e);var t=Object(X.a)(n);function n(){return Object(j.a)(this,n),t.apply(this,arguments)}return n}(M({id:$,questions:_.a.list(Ae),points:_.a.Number},"Game")),Me=function(){function e(){Object(j.a)(this,e)}return Object(b.a)(e,null,[{key:"startSinglePlayerGame",value:function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.post("game_definition",{type:t});case 2:return n=e.sent,e.abrupt("return",V.post("game",{gameDefinition:n.id},{expand:"questions",Model:Pe}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"submitQuestion",value:function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",V.patch("question/".concat(t.id),{selectedAnswer:t.selectedAnswer},{Model:Re}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getBattle",value:function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",V.get("game/".concat(t),{expand:"questions",Model:Pe}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Ge=n(93),De=n.n(Ge),Ie=n(74),Le=n.n(Ie),He=n(124),ze=n.n(He),Qe=n(123),We=n.n(Qe),qe=n(206),Ke=n.n(qe),Ve=n(205),Je=n.n(Ve);var Xe=function(){return Object(Fe.A)()===Fe.l?Object(r.jsx)(Je.a,{}):Object(r.jsx)(Ke.a,{})};function Ye(e){var t=e.panelHeaderProps,n=e.onBackButtonClick,a=e.text,c=e.showBackButton,i=Object(ae.a)({},t);return i.left=c?Object(r.jsx)(Fe.q,{onClick:n,children:Object(r.jsx)(Xe,{})}):void 0,Object(r.jsx)(Fe.p,Object(ae.a)(Object(ae.a)({},i),{},{children:a}))}Ye.defaultProps={panelHeaderProps:{},showBackButton:!0,onBackButtonClick:function(){}};var Ze=function(e){var t=e.delay,n=void 0===t?200:t,c=e.render,i=void 0===c?function(){return Object(r.jsx)(Fe.r,{size:"large"})}:c,o=Object(a.useState)(!1),s=Object(v.a)(o,2),u=s[0],l=s[1];return Object(a.useEffect)((function(){var e=setTimeout((function(){l(!0)}),n);return function(){clearTimeout(e)}}),[n]),u?i():null},$e=n(108),et=n(417),tt=["on","1","true","yes"];function nt(e){var t=Object(a.useContext)($e.a).isReady,n=Object(et.a)([e]),r=Boolean(n[e])&&n[e].treatment;return{isReady:t,enabled:tt.includes(r)}}var rt,at="multiplayer",ct=function(e){var t=e.onStartSingleGame,n=e.onStartMultiplayerGame,c=e.user,i=void 0===c?null:c,o=e.onUpdateUser,s=Object(a.useState)(!1),u=Object(v.a)(s,2),j=u[0],b=u[1],f=nt(at).enabled,p=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.target.checked,b(!0),e.prev=2,!n){e.next=9;break}return e.next=6,Ce.requestNotifications();case 6:r=e.sent,e.next=12;break;case 9:return e.next=11,Ce.blockNotifications();case 11:r=e.sent;case 12:o(r);case 13:return e.prev=13,b(!1),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[2,,13,16]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Ye,{text:"English Clash",showBackButton:!1}),i&&Object(r.jsx)(De.a,{children:Object(r.jsx)(Le.a,{before:i.photoUrl?Object(r.jsx)(We.a,{src:i.photoUrl}):null,description:Object(r.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(r.jsxs)("span",{children:["\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043e\u0447\u043a\u043e\u0432 - ",i.score]})," ",Object(r.jsxs)("span",{children:["\u041c\u0435\u0441\u0442\u043e \u0432 \u0440\u0435\u0439\u0442\u0438\u043d\u0433\u0435: ",i.foreverRank]})]}),multiline:!0,children:"".concat(i.firstName," ").concat(i.lastName)})}),Object(r.jsx)(De.a,{children:Object(r.jsxs)(ze.a,{children:[Object(r.jsx)(Le.a,{children:Object(r.jsx)(O.a,{size:"xl",onClick:t,disabled:j,children:"\u041d\u0430\u0447\u0430\u0442\u044c \u043e\u0434\u0438\u043d\u043e\u0447\u043d\u0443\u044e \u0438\u0433\u0440\u0443"})}),f&&Object(r.jsx)(Le.a,{children:Object(r.jsx)(O.a,{size:"xl",onClick:n,disabled:j,children:"\u0418\u0433\u0440\u0430\u0442\u044c \u0441 \u0434\u0440\u0443\u0433\u043e\u043c"})})]})}),i&&Object(r.jsx)(De.a,{children:Object(r.jsx)(Le.a,{multiline:!0,indicator:Object(r.jsx)(Fe.u,{checked:i.notificationsStatus===ee.ALLOW,onChange:p,disabled:j}),children:"\u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f \u043e\u0431 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f\u0445"})}),j&&Object(r.jsx)(Ze,{})]})},it=(n(394),n(207)),ot=function(){function e(){Object(j.a)(this,e)}return Object(b.a)(e,null,[{key:"createFullPictureUrl",value:function(t){var n=e.removePrecedingSlash(t);return V.createFullUrl(n)}},{key:"removePrecedingSlash",value:function(e){return e.startsWith("/")?e.slice(1):e}}]),e}(),st=(rt={},Object(S.a)(rt,te,(function(e){return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)("p",{children:["\u0421\u043b\u043e\u0432\u043e \u043d\u0430 \u0430\u043d\u0433\u043b\u0438\u0439\u0441\u043a\u043e\u043c: ",e]}),Object(r.jsx)("p",{children:"\u0412\u044b\u0431\u0435\u0440\u0438 \u0435\u0433\u043e \u043f\u0435\u0440\u0435\u0432\u043e\u0434 \u043d\u0430 \u0440\u0443\u0441\u0441\u043a\u0438\u0439:"})]})})),Object(S.a)(rt,ne,(function(e){return Object(r.jsxs)("div",{className:"picture-question",children:[Object(r.jsx)("img",{src:ot.createFullPictureUrl(e),alt:"\u041a\u0430\u0440\u0442\u0438\u043d\u043a\u0430 \u0441 \u0432\u043e\u043f\u0440\u043e\u0441\u043e\u043c"}),Object(r.jsx)("span",{children:"\u042d\u0442\u043e -"})]})})),rt);var ut=function(e){var t=e.question,n=e.gameType,a=e.onSelectAnswer,c=t.answerWords,i=t.selectedAnswer,o=t.isCorrect,s=t.correctAnswer,u=t.question,l=st[n];return Object(r.jsxs)(ze.a,{children:[Object(r.jsx)(Fe.j,{children:l(u)}),c.map((function(e){var t=e===s,n=!o&&e===i,c=Object(it.a)("answer-button",{correct:t,failure:n});return Object(r.jsx)(O.a,{size:"xl",mode:"primary",stretched:!0,className:c,onClick:function(){return!i&&a(e)},children:e},e)}))]})},lt="setBattle",dt="updateQuestion",jt="goToNextQuestion",bt={battle:null,activeQuestion:null,hasNextQuestion:!1};function ft(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case lt:var n=t.payload,r=n.questions;return Object(ae.a)(Object(ae.a)({},e),{},{battle:n,activeQuestion:r[0],hasNextQuestion:r.length>1});case dt:var a=t.payload,c=e.battle.questions,i=c.findIndex((function(e){return e.id===a.id})),o=[].concat(Object(Ee.a)(c.slice(0,i)),[a],Object(Ee.a)(c.slice(i+1)));return Object(ae.a)(Object(ae.a)({},e),{},{battle:Object(ae.a)(Object(ae.a)({},e.battle),{},{questions:o}),activeQuestion:a});case jt:var s=e.battle.questions,u=s.findIndex((function(t){return t.id===e.activeQuestion.id}));if(u===s.length-1)throw new Error("\u0412\u044b \u0443\u0436\u0435 \u043d\u0430 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u043c \u0432\u043e\u043f\u0440\u043e\u0441\u0435");var l=u+1;return Object(ae.a)(Object(ae.a)({},e),{},{activeQuestion:s[l],hasNextQuestion:l<s.length-1});default:return e}}var pt=n(208),ht=(n(395),function(e){var t=e.onGoBack,n=e.onFinishGame,c=e.gameType,i=void 0===c?null:c,o=e.gameMode,s=void 0===o?null:o,u=e.game,j=void 0===u?null:u,b=Object(a.useState)(!1),p=Object(v.a)(b,2),h=p[0],O=p[1],m=Object(a.useReducer)(ft,bt),x=Object(v.a)(m,2),k=x[0],g=x[1],w=k.battle,y=k.activeQuestion,S=k.hasNextQuestion,N=Object(a.useState)(0),T=Object(v.a)(N,2),C=T[0],_=T[1],E=Object(a.useState)(!1),B=Object(v.a)(E,2),U=B[0],F=B[1];Object(a.useEffect)((function(){j&&(g({type:lt,payload:j}),s===G.multi?_(3):F(!0))}),[j,s]);var R=w&&!U?1e3:null;Object(pt.a)((function(){1===C?F(!0):_(C-1)}),R);var A=function(){var e=Object(d.a)(l.a.mark((function e(t){var r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!h){e.next=2;break}return e.abrupt("return");case 2:return r=y.set("selectedAnswer",t),O(!0),e.prev=4,e.next=7,Me.submitQuestion(r);case 7:a=e.sent,g({type:dt,payload:a});case 9:return e.prev=9,O(!1),e.finish(9);case 12:return e.next=14,f.waitForTimeout(1e3);case 14:S?g({type:jt}):n(w);case 15:case"end":return e.stop()}}),e,null,[[4,,9,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Ye,{onBackButtonClick:t,text:"\u0418\u0433\u0440\u0430"}),U&&y&&Object(r.jsx)(ut,{question:y,onSelectAnswer:A,gameType:i}),!U&&Object(r.jsxs)(Fe.g,{className:"start-game-timer",children:["\u0414\u043e \u043d\u0430\u0447\u0430\u043b\u0430 \u0438\u0433\u0440\u044b: ",C]}),h&&Object(r.jsx)(Ze,{})]})}),Ot=n(127),mt=n.n(Ot),vt=n(211),xt=n.n(vt),kt=(n(396),n(210)),gt=n.n(kt),wt=n(412),yt=n(209),St=n.n(yt);var Nt=function(e){return Object(r.jsx)(O.a,Object(ae.a)(Object(ae.a)({size:"l",before:Object(r.jsx)(St.a,{})},e),{},{children:"\u0414\u043e\u043c\u043e\u0439"}))};var Tt=function(e){var t=e.user,n=void 0===t?null:t,c=e.onGoBack,i=e.battle,o=void 0===i?null:i,s=e.onRetry,u=e.onUpdateUser,j=o.questions,b=o.points,f=j.filter((function(e){return e.isCorrect})).length,p=j.length-f,h=Object(a.useState)(!1),m=Object(v.a)(h,2),x=m[0],k=m[1],g=Object(a.useState)(!1),w=Object(v.a)(g,2),y=w[0],S=w[1],N=n.notificationsStatus===ee.TO_BE_REQUESTED,T=Object(r.jsxs)("div",{className:"action-buttons-wrapper",children:[Object(r.jsx)(Nt,{onClick:c}),Object(r.jsx)(O.a,{onClick:s,size:"l",before:Object(r.jsx)(gt.a,{}),children:"\u0415\u0449\u0435 \u0440\u0430\u0437"})]});function C(){return(C=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!y){e.next=2;break}return e.abrupt("return");case 2:return S(!0),e.prev=3,e.next=6,Ce.requestNotifications();case 6:t=e.sent,u(t),t.notificationsStatus===ee.BLOCK&&k(!0);case 9:return e.prev=9,S(!1),e.finish(9);case 12:case"end":return e.stop()}}),e,null,[[3,,9,12]])})))).apply(this,arguments)}function _(){return E.apply(this,arguments)}function E(){return(E=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!y){e.next=2;break}return e.abrupt("return");case 2:return S(!0),e.prev=3,e.t0=u,e.next=7,Ce.blockNotifications();case 7:e.t1=e.sent,(0,e.t0)(e.t1),k(!0);case 10:return e.prev=10,S(!1),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[3,,10,13]])})))).apply(this,arguments)}var B=Object(r.jsx)(Fe.d,{style:{marginTop:"10px"},children:Object(r.jsx)(Fe.c,{size:"l",style:{padding:"10px"},children:Object(r.jsxs)("div",{className:"notification-request-content",children:[Object(r.jsx)("span",{className:"notification-request-header",children:"\u0423\u0437\u043d\u0430\u0439 \u043f\u0435\u0440\u0432\u044b\u043c \u043e\u0431 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f\u0445 - \u043f\u043e\u0434\u043f\u0438\u0448\u0438\u0441\u044c \u043d\u0430 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f!"}),Object(r.jsxs)("div",{className:"notification-buttons-wrapper",children:[Object(r.jsx)(O.a,{size:"m",mode:"commerce",className:"notification-button",onClick:function(){return C.apply(this,arguments)},disabled:y,children:"\u041f\u043e\u0434\u043f\u0438\u0441\u0430\u0442\u044c\u0441\u044f"}),Object(r.jsx)(O.a,{size:"m",mode:"secondary",className:"notification-button",onClick:_,disabled:y,children:"\u041d\u0435 \u0441\u0435\u0439\u0447\u0430\u0441"})]}),Object(r.jsx)("span",{className:"notification-request-close",children:Object(r.jsx)(wt.a,{onClick:_})}),Object(r.jsx)("span",{className:"notification-request-subtext",children:"\u0412\u0441\u0435\u0433\u0434\u0430 \u043c\u043e\u0436\u043d\u043e \u043e\u0442\u043f\u0438\u0441\u0430\u0442\u044c\u0441\u044f \u043d\u0430 \u0433\u043b\u0430\u0432\u043d\u043e\u043c \u044d\u043a\u0440\u0430\u043d\u0435"})]})})});return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Ye,{text:"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b",onBackButtonClick:c}),Object(r.jsxs)(De.a,{header:Object(r.jsx)(xt.a,{mode:"secondary",children:"\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430"}),children:[Object(r.jsx)(Le.a,{indicator:Object(r.jsx)(mt.a,{mode:"primary",children:f}),children:"\u0412\u0435\u0440\u043d\u044b\u0445 \u043e\u0442\u0432\u0435\u0442\u043e\u0432:"}),Object(r.jsx)(Le.a,{indicator:Object(r.jsx)(mt.a,{mode:"primary",children:p}),children:"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0445 \u043e\u0442\u0432\u0435\u0442\u043e\u0432:"}),Object(r.jsx)(Le.a,{indicator:Object(r.jsx)(mt.a,{mode:"primary",children:b}),children:"\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u043e \u043e\u0447\u043a\u043e\u0432:"})]}),!N&&T,N&&B,x&&Object(r.jsx)(Fe.g,{className:"subscribe-later",children:"\u041f\u043e\u0434\u043f\u0438\u0441\u0430\u0442\u044c\u0441\u044f \u043c\u043e\u0436\u043d\u043e \u043d\u0430 \u0433\u043b\u0430\u0432\u043d\u043e\u043c \u044d\u043a\u0440\u0430\u043d\u0435"}),y&&Object(r.jsx)(Ze,{})]})},Ct=n(415),_t=n(416),Et=function(e){Object(J.a)(n,e);var t=Object(X.a)(n);function n(){return Object(j.a)(this,n),t.apply(this,arguments)}return n}(M({id:$,firstName:_.a.String,lastName:_.a.String,photoUrl:_.a.String,score:Z},"ScoreboardUser"));n(398);var Bt=function(e){var t=e.rank,n=e.score,a=e.photoUrl,c=e.firstName,i=e.lastName;return Object(r.jsx)(Fe.s,{before:Object(r.jsx)(Fe.f,{children:t}),after:n,children:Object(r.jsxs)("div",{className:"scoreboard-item",children:[Object(r.jsx)(Fe.a,{size:40,src:a}),Object(r.jsxs)("div",{className:"scoreboard-item-name",children:[c," ",i]})]})})},Ut="forever",Ft="monthly";var Rt=function(e){var t=e.user,n=void 0===t?null:t,c=Object(a.useState)([]),i=Object(v.a)(c,2),o=i[0],s=i[1],u=Object(a.useState)(!1),j=Object(v.a)(u,2),b=j[0],f=j[1],p=Object(a.useState)(Ut),h=Object(v.a)(p,2),O=h[0],m=h[1],x=Object(a.useState)(!1),k=Object(v.a)(x,2),g=k[0],w=k[1];return Object(a.useEffect)((function(){(function(){var e=Object(d.a)(l.a.mark((function e(){var t,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s([]),f(!0),e.next=4,V.get("".concat(O,"_scoreboard"));case 4:t=e.sent,r=Et.fromObject(Object(ae.a)({},n)),w(Boolean(t.find((function(e){return e.id===r.id})))),s(t),f(!1);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[O,n]),Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Ye,{text:"\u0420\u0435\u0439\u0442\u0438\u043d\u0433",showBackButton:!1}),Object(r.jsx)(Fe.i,{vertical:"top",children:Object(r.jsxs)(Fe.x,{children:[Object(r.jsx)(Fe.y,{selected:O===Ut,onClick:function(){return m(Ut)},children:"\u0417\u0430 \u0432\u0441\u0435 \u0432\u0440\u0435\u043c\u044f"}),Object(r.jsx)(Fe.y,{selected:O===Ft,onClick:function(){return m(Ft)},children:"\u0417\u0430 \u043c\u0435\u0441\u044f\u0446"})]})}),Object(r.jsx)(Fe.g,{children:Object(r.jsxs)(Fe.j,{style:{paddingTop:"20px"},children:[!b&&Object(r.jsxs)(Fe.n,{children:[o.map((function(e,t){var n=e.id,a=e.firstName,c=e.lastName,i=e.photoUrl,o=e.score;return Object(r.jsx)(Bt,{rank:t+1,score:o,photoUrl:i,firstName:a,lastName:c},n)})),!g&&Object(r.jsx)(Bt,{rank:O===Ut?n.foreverRank:n.monthlyRank,score:O===Ut?n.score:n.monthlyScore,photoUrl:n.photoUrl,firstName:n.firstName,lastName:n.lastName})]}),b&&Object(r.jsx)(Ze,{})]})})]})};n(399);var At=function(e){var t=e.onGoBack,n=e.onChoose;return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Ye,{text:"\u0422\u0438\u043f \u0438\u0433\u0440\u044b",onBackButtonClick:t}),Object(r.jsxs)(Fe.g,{children:[Object(r.jsx)(Fe.k,{mode:"primary",children:"\u0412\u044b\u0431\u0435\u0440\u0438 \u0442\u0438\u043f \u0438\u0433\u0440\u044b:"}),Object(r.jsxs)("div",{className:"choose-game-type-body",children:[Object(r.jsx)(Fe.b,{size:"l",onClick:function(){return n(ne)},children:"\u041a\u0430\u0440\u0442\u0438\u043d\u043a\u0430"}),Object(r.jsx)(Fe.b,{size:"l",onClick:function(){return n(te)},children:"\u041f\u0435\u0440\u0435\u0432\u043e\u0434"})]})]})]})},Pt=n(413),Mt=n(414),Gt=(n(400),V.removeTrailingSlash("https://vk.com/app7717529"));var Dt=function(e){var t=e.gameDefinition,n=e.onGoBack,c=Object(a.useState)(!1),i=Object(v.a)(c,2),o=i[0],u=i[1];if(!t)return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Ye,{text:"\u0418\u0433\u0440\u0430 \u0441 \u0434\u0440\u0443\u0437\u044c\u044f\u043c\u0438",onBackButtonClick:n}),Object(r.jsx)(Ze,{})]});var j="".concat(Gt,"#gid=").concat(t.id),b=function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.send("VKWebAppCopyText",{text:t});case 2:u(!0);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Ye,{text:"\u0418\u0433\u0440\u0430 \u0441 \u0434\u0440\u0443\u0433\u043e\u043c",onBackButtonClick:n}),Object(r.jsx)(Fe.j,{children:Object(r.jsxs)(Fe.g,{children:[Object(r.jsxs)("div",{className:"method-wrapper",children:[Object(r.jsx)("div",{className:"invite-help-text",children:"\u041e\u0442\u043f\u0440\u0430\u0432\u044c \u0434\u0440\u0443\u0433\u043e\u043c\u0443 \u0447\u0435\u043b\u043e\u0432\u0435\u043a\u0443 \u044d\u0442\u0443 \u0441\u0441\u044b\u043b\u043a\u0443, \u0447\u0442\u043e\u0431\u044b \u043e\u043d(\u0430) \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u043b\u0441\u044f \u043a \u0438\u0433\u0440\u0435"}),Object(r.jsxs)("div",{className:"input-wrapper",children:[Object(r.jsx)(Fe.m,{className:"invite-url-input",value:j,readOnly:!0}),Object(r.jsx)(Fe.b,{onClick:function(){return b(j)},className:"copy-button",before:Object(r.jsx)(Pt.a,{}),children:Object(r.jsx)("span",{className:"button-subtitle",children:"\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})}),Object(r.jsx)(Fe.b,{onClick:function(){return s.a.send("VKWebAppShare",{link:j})},className:"share-button",before:Object(r.jsx)(Mt.a,{}),children:Object(r.jsx)("span",{className:"button-subtitle",children:"\u041f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f"})})]})]}),Object(r.jsxs)("div",{className:"method-wrapper second-method",children:[Object(r.jsx)("div",{className:"invite-help-text",children:"\u0415\u0449\u0435 \u043c\u043e\u0436\u043d\u043e \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c\u0441\u044f \u043f\u043e ID \u0438\u0433\u0440\u044b"}),Object(r.jsxs)("div",{className:"input-wrapper",children:[Object(r.jsx)(Fe.m,{className:"invite-url-input",value:t.id,readOnly:!0}),Object(r.jsx)(Fe.b,{onClick:function(){return b(t.id)},className:"copy-button",before:Object(r.jsx)(Pt.a,{}),children:Object(r.jsx)("span",{className:"button-subtitle",children:"\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})})]})]}),Object(r.jsxs)("div",{className:"loader-wrapper",children:[Object(r.jsx)(Ze,{}),Object(r.jsx)("span",{className:"loader-caption",children:"\u041e\u0436\u0438\u0434\u0430\u0435\u043c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0432\u0442\u043e\u0440\u043e\u0433\u043e \u0447\u0435\u043b\u043e\u0432\u0435\u043a\u0430"})]}),o&&Object(r.jsx)(Fe.t,{onClose:function(){return u(!1)},duration:3e3,children:"\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u043e"})]})})]})},It=function(e){Object(J.a)(n,e);var t=Object(X.a)(n);function n(){return Object(j.a)(this,n),t.apply(this,arguments)}return n}(M({id:_.a.String,creator:$,players:_.a.list($),type:_.a.String},"GameDefinition"));n(401);var Lt=function(e){var t=e.onCreateNew,n=e.onJoin,a=e.onGoBack;return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Ye,{text:"\u0412\u044b\u0431\u0435\u0440\u0438 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435",onBackButtonClick:a}),Object(r.jsxs)(Fe.g,{children:[Object(r.jsx)(Fe.k,{mode:"primary",children:"\u0412\u044b\u0431\u0435\u0440\u0438 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435:"}),Object(r.jsxs)("div",{className:"choose-action-buttons-wrapper",children:[Object(r.jsx)(Fe.b,{onClick:t,size:"xl",stretched:!0,children:"\u041d\u0430\u0447\u0430\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u0438\u0433\u0440\u0443"}),Object(r.jsx)(Fe.b,{onClick:n,size:"xl",stretched:!0,children:"\u041f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c\u0441\u044f \u043a \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0435\u0439"})]})]})]})};n(402);var Ht=function(e){var t=e.onJoin,n=e.onBack,c=Object(a.useState)(""),i=Object(v.a)(c,2),o=i[0],s=i[1];return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Ye,{text:"\u041f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c\u0441\u044f \u043a \u0438\u0433\u0440\u0435",onBackButtonClick:n}),Object(r.jsxs)(Fe.g,{children:[Object(r.jsx)("div",{className:"join-game-help-text",children:"\u041f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c\u0441\u044f \u043a \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0435\u0439 \u0438\u0433\u0440\u0435 \u043f\u043e ID:"}),Object(r.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t(o)},children:[Object(r.jsx)(Fe.m,{onChange:function(e){s(e.target.value)}}),Object(r.jsx)(Fe.g,{children:Object(r.jsx)(Fe.b,{type:"submit",stretched:!0,size:"xl",children:"\u041f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c\u0441\u044f"})})]})]})]})},zt=n(68),Qt=n.n(zt);var Wt=function(e){var t=e.onGoBack,n=e.items,a=e.playersNumber,c=2===a?"\u043e\u0436\u0438\u0434\u0430\u0435\u043c \u0434\u0440\u0443\u0433\u043e\u0433\u043e \u0438\u0433\u0440\u043e\u043a\u0430":"\u043e\u0436\u0438\u0434\u0430\u0435\u043c \u0434\u0440\u0443\u0433\u0438\u0445 \u0438\u0433\u0440\u043e\u043a\u043e\u0432";return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Ye,{text:"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b",onBackButtonClick:t}),Object(r.jsxs)(Fe.j,{children:[Object(r.jsxs)("div",{children:[Object(r.jsx)(Fe.e,{children:Object(r.jsxs)("div",{className:Qt.a.headerRow,children:[Object(r.jsx)("span",{className:Qt.a.nameHeader,children:"\u0418\u0433\u0440\u043e\u043a"}),Object(r.jsx)("span",{className:Qt.a.answersHeader,children:"\u0412\u0435\u0440\u043d\u044b\u0445 \u043e\u0442\u0432\u0435\u0442\u043e\u0432"}),Object(r.jsx)("span",{children:"\u0421\u0447\u0435\u0442"})]})}),n.map((function(e){var t=e.user,n=e.correctAnswersNumber,a=e.totalQuestions,c=e.points;return Object(r.jsx)(Fe.e,{className:Qt.a.dataRowWrapper,children:Object(r.jsxs)("div",{className:Qt.a.dataRow,children:[Object(r.jsx)(We.a,{src:t.photoUrl}),Object(r.jsx)("span",{className:Qt.a.name,children:t.firstName}),Object(r.jsxs)("span",{className:Qt.a.answers,children:[n," \u0438\u0437 ",a]}),Object(r.jsx)("span",{children:c})]})},t.id)}))]}),n.length<a&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Ze,{}),Object(r.jsx)("div",{className:Qt.a.loaderText,children:c})]}),Object(r.jsx)("div",{className:Qt.a.homeButtonWrapper,children:Object(r.jsx)(Nt,{onClick:t})})]})]})};var qt=function(e){var t=e.user,n=e.loadingUser,c=e.setUser,i=e.refreshUser,o=e.popout,s=Object(a.useState)(!1),u=Object(v.a)(s,2),j=u[0],b=u[1],p=Object(a.useState)(!1),h=Object(v.a)(p,2),O=h[0],m=h[1],x=Object(a.useState)(!1),k=Object(v.a)(x,2),g=k[0],w=k[1],y=Object(a.useState)("game"),S=Object(v.a)(y,2),N=S[0],T=S[1],C=Object(a.useState)("home"),_=Object(v.a)(C,2),E=_[0],B=_[1],U=Object(a.useState)(null),F=Object(v.a)(U,2),R=F[0],A=F[1],P=Object(a.useState)(null),M=Object(v.a)(P,2),I=M[0],L=M[1],H=Object(a.useState)(null),z=Object(v.a)(H,2),Q=z[0],W=z[1],J=function(e){var t=Object(a.useState)(e),n=Object(v.a)(t,2),r=n[0],c=n[1],i=Object(a.useRef)(e);return i.current=r,[r,Object(a.useCallback)((function(e){i.current=e,c(e)}),[]),i]}(null),X=Object(v.a)(J,3),Y=X[0],Z=X[1],$=X[2],ee=Object(a.useState)(null),te=Object(v.a)(ee,2),ne=te[0],re=te[1],ce=Object(a.useState)([]),ie=Object(v.a)(ce,2),oe=ie[0],se=ie[1],ue=Object(a.useRef)(null),le=nt(at).enabled,de=Object(a.useCallback)((function(e){var t=e.instance;Z(t)}),[Z]),je=Object(a.useCallback)(function(){var e=Object(d.a)(l.a.mark((function e(t,n){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.instance,re(r),!n){e.next=6;break}return 900,e.next=6,f.waitTillTimestamp(n+900);case 6:B("battle");case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[]),be=Object(a.useCallback)((function(e){var t=e.instance,n=e.data;se((function(e){return e.length===$.current.players.length-1&&ue.current.close(q),[].concat(Object(Ee.a)(e),[Object(ae.a)({user:t},n)])}))}),[$,ue]),pe=Object(a.useCallback)(function(){var e=Object(d.a)(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(!0),e.prev=1,e.next=4,V.get("game_definition/".concat(t),{Model:It});case 4:n=e.sent,Z(n),r=(new Date).getTime(),B("lobby"),L(n.type),ue.current=V.openSocketConnection("multiplayer-game/".concat(t),{joinedGame:de,startedGame:function(e){var t=e.instance;return je({instance:t},r)},finishedGame:be}),e.next=19;break;case 12:if(e.prev=12,e.t0=e.catch(1),"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430."!==e.t0.message){e.next=18;break}throw new Error("\u0418\u0433\u0440\u0430 \u0434\u043b\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430");case 18:throw e.t0;case 19:return e.prev=19,b(!1),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[1,12,19,22]])})));return function(t){return e.apply(this,arguments)}}(),[je,be,de,Z]);Object(a.useEffect)((function(){if(le){var e=D.getHashParam("gid");e&&(pe(e),W(G.multi))}}),[pe,le]);var he=function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Me.getBattle(t.id);case 2:n=e.sent,A(n),B("results"),Te("finish-game"),fe.reachGoal("conversion"),i();case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Oe=function(){return B("home")},me=function(e){e!==Q&&W(e),B("choose-game-type")};function ve(e){return xe.apply(this,arguments)}function xe(){return(xe=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.post("game_definition",{type:t},{Model:It});case 2:return n=e.sent,Z(n),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ke=function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),e.prev=1,e.next=4,Me.startSinglePlayerGame(t);case 4:n=e.sent,re(n);case 6:return e.prev=6,m(!1),e.finish(6);case 9:case"end":return e.stop()}}),e,null,[[1,,6,9]])})));return function(t){return e.apply(this,arguments)}}(),ge=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==I&&L(t),Q!==G.single){e.next=7;break}return e.next=4,ke(t);case 4:B("battle"),e.next=13;break;case 7:return n=ve(t),B("lobby"),e.next=11,n;case 11:r=e.sent,ue.current=V.openSocketConnection("multiplayer-game/".concat(r.id),{joinedGame:function(e){var t=e.instance;de({instance:t}),2===t.players.length&&(ue.current.sendEvent("start-game"),Te("launch-multiplayer-game"))},startedGame:je,finishedGame:be});case 13:Te("start-game",{type:t,mode:Q});case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),we=n||j||O;Object(a.useEffect)((function(){var e;return we?e=window.setTimeout((function(){w(!0)}),200):w(!1),function(){clearTimeout(e)}}),[we]),Object(a.useEffect)((function(){Q===G.multi&&"game"!==N&&ue.current.close(K)}),[N,ue,Q]);var ye=null;return o?ye=o:we&&g&&(ye=Object(r.jsx)(Ue.a,{})),Object(r.jsxs)(Fe.h,{activeStory:N,tabbar:Object(r.jsxs)(Fe.v,{children:[Object(r.jsx)(Fe.w,{text:"\u0413\u043b\u0430\u0432\u043d\u0430\u044f",selected:"game"===N,onClick:function(){T("game"),B("home")},children:Object(r.jsx)(Ct.a,{})}),Object(r.jsx)(Fe.w,{text:"\u0420\u0435\u0439\u0442\u0438\u043d\u0433",selected:"scoreboard"===N,onClick:function(){T("scoreboard"),B("scoreboard-home")},children:Object(r.jsx)(_t.a,{})})]}),children:[Object(r.jsxs)(Fe.z,{id:"game",activePanel:E,popout:ye,children:[Object(r.jsx)(Fe.o,{id:"home",children:Object(r.jsx)(ct,{user:t,onStartSingleGame:function(){return me(G.single)},onStartMultiplayerGame:function(){W(G.multi),B("choose-multiplayer-game-action")},onUpdateUser:function(e){return c(e)}})}),Object(r.jsx)(Fe.o,{id:"choose-multiplayer-game-action",children:Object(r.jsx)(Lt,{onCreateNew:function(){B("choose-game-type")},onJoin:function(){B("join-multiplayer-game")},onGoBack:Oe})}),Object(r.jsx)(Fe.o,{id:"choose-game-type",children:Object(r.jsx)(At,{onGoBack:function(){Q===G.multi?B("choose-multiplayer-game-action"):Oe()},onChoose:ge})}),Object(r.jsx)(Fe.o,{id:"join-multiplayer-game",children:Object(r.jsx)(Ht,{onJoin:function(e){pe(e)},onBack:function(){B("choose-multiplayer-game-action")}})}),Object(r.jsx)(Fe.o,{id:"lobby",children:Object(r.jsx)(Dt,{gameDefinition:Y,onGoBack:function(){me(Q),ue.current.close(K)}})}),Object(r.jsx)(Fe.o,{id:"battle",children:Object(r.jsx)(ht,{onGoBack:function(){me(Q),Q===G.multi&&ue.current.close(K)},onFinishGame:he,gameType:I,gameMode:Q,game:ne})}),Object(r.jsxs)(Fe.o,{id:"results",children:[Q===G.single&&Object(r.jsx)(Tt,{user:t,onRetry:function(){return ge(I)},onGoBack:Oe,battle:R,onUpdateUser:function(e){return c(e)}}),Q===G.multi&&Object(r.jsx)(Wt,{onGoBack:function(){Oe(),ue.current.close(K)},items:oe,playersNumber:Y&&Y.players.length||0})]})]}),Object(r.jsx)(Fe.z,{id:"scoreboard",activePanel:E,popout:o,children:Object(r.jsx)(Fe.o,{id:"scoreboard-home",children:Object(r.jsx)(Rt,{user:t})})})]})},Kt=n(406),Vt=n(215),Jt=n.n(Vt),Xt=n(213),Yt=n.n(Xt),Zt=n(418),$t=n(214),en=function(){function e(){Object(j.a)(this,e)}return Object(b.a)(e,null,[{key:"getDevFlagsFrom",value:function(e){var t,n={},r=new URLSearchParams(e),a=Object($t.a)(r.entries());try{for(a.s();!(t=a.n()).done;){var c=Object(v.a)(t.value,2),i=c[0],o=c[1];if(i.startsWith("feature"))n[i.replace(/^feature_/,"")]=o}}catch(s){a.e(s)}finally{a.f()}return n}},{key:"getDevFeatureFlags",value:function(){return Object(ae.a)(Object(ae.a)({},e.getDevFlagsFrom(window.location.search)),e.getDevFlagsFrom(window.location.hash.slice(1)))}}]),e}();var tn=function(e){var t=e.user,n=e.children;if(null===t)return n;var a={core:{authorizationKey:"dsr9kgv3ebr47m7563n92hnr0tlj2auamp61",key:String(t.vkId)}};return f.isProductionMode||(a.core.authorizationKey="localhost",a.features=en.getDevFeatureFlags()),Object(r.jsx)(Zt.a,{config:a,children:n})};var nn=function(){var e=Object(a.useState)(null),t=Object(v.a)(e,2),n=t[0],c=t[1];return Object(a.useEffect)((function(){f.isProductionMode&&Kt.a({dsn:"https://ae49049c58d94887bed337d523675ca6@o158161.ingest.sentry.io/5554359",beforeSend:function(e,t){if(e.exception){var n=t&&t.originalException&&t.originalException instanceof Error&&t.originalException.message?t.originalException.message:"";c(Object(r.jsxs)(Jt.a,{actions:[{mode:"default",title:"\u041e\u041a",autoclose:!0}],onClose:function(){return c(null)},children:[Object(r.jsx)("h2",{children:"\u0412\u043e\u0437\u043d\u0438\u043a\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 =("}),n&&Object(r.jsx)("p",{className:Yt.a.errorMessage,children:n}),Object(r.jsx)("p",{children:"\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439 \u0435\u0449\u0435 \u0440\u0430\u0437"})]}))}return e}}),Ne(),Te("open app")}),[]),Object(r.jsx)(_e,{children:function(e){var t=e.loadingUser,a=e.user,c=e.setUser,i=e.refreshUser;return Object(r.jsx)(tn,{user:a,children:Object(r.jsx)(qt,{user:a,loadingUser:t,setUser:c,refreshUser:i,popout:n})})}})};s.a.send("VKWebAppInit"),s.a.subscribe((function(e){var t=e.detail,n=t.type,r=t.data;if("VKWebAppUpdateConfig"===n){var a=document.createAttribute("scheme");a.value=r.scheme||"client_light",document.body.attributes.setNamedItem(a)}})),Object(i.render)(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(m,{children:Object(r.jsx)(nn,{})})}),document.getElementById("root")),f.isProductionMode||Promise.all([n.e(3),n.e(4)]).then(n.bind(null,422))},68:function(e,t,n){e.exports={headerRow:"MultiplayerResults_headerRow__y5pM1",answersHeader:"MultiplayerResults_answersHeader__3NEgp",nameHeader:"MultiplayerResults_nameHeader__Hh72X",dataRowWrapper:"MultiplayerResults_dataRowWrapper__yZ66X",dataRow:"MultiplayerResults_dataRow__2DcDp",name:"MultiplayerResults_name__og7Wz",answers:"MultiplayerResults_answers__Hnaj0",loaderText:"MultiplayerResults_loaderText__2FoPw",homeButtonWrapper:"MultiplayerResults_homeButtonWrapper__3ataf"}}},[[404,1,2]]]);
//# sourceMappingURL=main.850cbbfa.chunk.js.map